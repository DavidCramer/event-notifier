var evenote_item_control_modal,evenote_item_control_modal_handler;!function(a){var b=null;flush_current=!1,evenote_item_control_modal=function(c){var d,e,f=a("#"+c.modal+"-tmpl"),g=Handlebars.compile(f.html()),h={};return null!==b&&flush_current===!1?(h={config:b.data("config")},d="add"):(b=null,flush_current=!1,d="update",h=c.trigger.data("default")),e=g(h),a('.evenote-modal-footer [data-state="'+d+'"]').remove(),e},evenote_item_control_modal_handler=function(e,f){var g,h=c(f.params.requestData.control,e.data);null!==b?(g=b,b=null,g.replaceWith(h)):(g=a("#"+f.params.requestData.control),h.appendTo(g)),d(a("#"+f.params.requestData.control))};var c=function(b,c){var d=a("#"+b+"-tmpl"),e=Handlebars.compile(d.html()),f=a(e(c));return f.data("config",c),a(document).trigger("evenote.init"),f},d=function(b){var c;c=a(b?b:".evenote-control-item");for(var d=0;d<c.length;d++){for(var e=a(c[d]),f=a("#"+e.prop("id")+"-control"),g=e.find(".evenote-item"),h=[],i=0;i<g.length;i++){var j=a(g[i]);h.push(j.data("config"))}f.val(JSON.stringify(h)).trigger("change")}a(document).trigger("evenote.save")};a(document).on("click",".evenote-item-edit",function(){var c=a(this),d=c.closest(".evenote-control-item"),e=a('button[data-modal="'+d.prop("id")+'-config"]');b=c.closest(".evenote-item"),flush_current=!1,e.trigger("click")}),a(document).on("click",".evenote-item-remove",function(){var b=a(this),c=b.closest(".evenote-control-item"),e=(a('button[data-modal="'+c.prop("id")+'-config"]'),b.closest(".evenote-item"));(!b.data("confirm")||confirm(b.data("confirm")))&&e.fadeOut(200,function(){e.remove(),d(c)})}),a(window).on("modals.closed",function(){flush_current=!0}),a(window).load(function(){a(document).on("evenote.init",function(){a(".evenote-control-item").not("._evenote_item_init").each(function(){var b,d=a(this),e=a("#"+d.prop("id")+"-control");try{b=JSON.parse(e.val())}catch(f){}if(d.addClass("_evenote_item_init"),"object"==typeof b&&b.length)for(var g=0;g<b.length;g++){var h=c(d.prop("id"),b[g]);h.appendTo(d)}d.removeClass("processing")})})})}(jQuery);